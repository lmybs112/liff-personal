# LIFF Scope æ¬Šé™å•é¡Œä¿®å¾©æŒ‡å—

## ğŸš¨ éŒ¯èª¤è¨Šæ¯

```
ç™¼é€å¤±æ•—ï¼šThe permission is not in LIFF app scope.
è«‹ç¢ºèª LIFF ID æ˜¯å¦æ­£ç¢º
```

## ğŸ” å•é¡ŒåŸå› 

æ‚¨çš„ LIFF App ç¼ºå°‘å¿…è¦çš„æ¬Šé™ï¼ˆScopesï¼‰ï¼Œå°è‡´ç„¡æ³•å–å¾—ä½¿ç”¨è€…è³‡è¨Šï¼ˆUser Profileï¼‰ã€‚

å³ä½¿æ‚¨åœ¨ LINE App ä¸­é–‹å•Ÿæ‡‰ç”¨ï¼Œä½† LIFF App æœ¬èº«æ²’æœ‰è¢«æˆæ¬Šå­˜å–ä½¿ç”¨è€…çš„å€‹äººè³‡æ–™ã€‚

---

## âœ… è§£æ±ºæ–¹æ¡ˆï¼ˆ2 åˆ†é˜æå®šï¼‰

### **æ­¥é©Ÿ 1ï¼šæ›´æ–° LIFF App Scopes**

#### 1.1 å‰å¾€ LINE Developers Console

ğŸ‘‰ [https://developers.line.biz/console/](https://developers.line.biz/console/)

#### 1.2 é¸æ“‡æ‚¨çš„ Channel

- é»æ“Šæ‚¨çš„ Provider
- é¸æ“‡æ­£ç¢ºçš„ Channelï¼ˆMessaging API Channelï¼‰

#### 1.3 ç·¨è¼¯ LIFF App

1. é»æ“Šå·¦å´é¸å–®çš„ **ã€ŒLIFFã€**
2. æ‰¾åˆ° LIFF IDï¼š`2008576354-nwJ6w230`
3. é»æ“Šè©² LIFF App æ—é‚Šçš„ **ã€ŒEditã€** æˆ–ã€Œç·¨è¼¯ã€æŒ‰éˆ•

#### 1.4 è¨­å®š Scopesï¼ˆé‡è¦ï¼ï¼‰

åœ¨ **ã€ŒScopesã€** å€å¡Šï¼Œç¢ºèªä»¥ä¸‹æ¬Šé™å·²å‹¾é¸ï¼š

```
âœ… profile        ï¼ˆå¿…é ˆï¼å–å¾—ä½¿ç”¨è€…åç¨±ã€å¤§é ­è²¼ã€ç‹€æ…‹è¨Šæ¯ï¼‰
âœ… openid         ï¼ˆå¿…é ˆï¼LIFF èªè­‰ï¼‰
âœ… email          ï¼ˆé¸ç”¨ï¼Œå¦‚éœ€ emailï¼‰
âœ… chat_message.write  ï¼ˆé¸ç”¨ï¼Œå¦‚éœ€å¾ LIFF ç™¼é€è¨Šæ¯åˆ°èŠå¤©å®¤ï¼‰
```

**æœ€é‡è¦çš„æ˜¯ï¼š`profile` å’Œ `openid` å¿…é ˆå‹¾é¸ï¼**

#### 1.5 å„²å­˜è¨­å®š

é»æ“Š **ã€ŒUpdateã€** æŒ‰éˆ•å„²å­˜è®Šæ›´ã€‚

#### 1.6 æˆªåœ–åƒè€ƒ

è¨­å®šå®Œæˆå¾Œï¼ŒScopes å€å¡Šæ‡‰è©²é¡¯ç¤ºï¼š

```
Scopes:
- profile
- openid
```

---

### **æ­¥é©Ÿ 2ï¼šæ¸…é™¤èˆŠçš„æˆæ¬Š**

æ›´æ–° Scopes å¾Œï¼Œå¿…é ˆæ¸…é™¤èˆŠçš„æˆæ¬Šï¼Œè®“ä½¿ç”¨è€…é‡æ–°æˆæ¬Šã€‚

#### **æ–¹æ³• Aï¼šä½¿ç”¨è‡¨æ™‚èª¿è©¦æŒ‰éˆ•ï¼ˆæœ€ç°¡å–®ï¼‰**

1. é‡æ–°æ•´ç†æ‚¨çš„ LIFF é é¢
2. æœƒçœ‹åˆ°ä¸€å€‹ç´…è‰²æŒ‰éˆ•ï¼š**ã€ŒğŸ”„ æ¸…é™¤æˆæ¬Šä¸¦é‡æ–°ç™»å…¥ã€**
3. é»æ“Šè©²æŒ‰éˆ•
4. é é¢æœƒè‡ªå‹•é‡æ–°æ•´ç†
5. å†æ¬¡é»æ“Šã€Œå–å¾—æœ€æ–°å„ªæƒ è³‡è¨Šã€
6. ç³»çµ±æœƒè¦æ±‚é‡æ–°æˆæ¬Šï¼ˆè«‹åŒæ„ï¼‰

#### **æ–¹æ³• Bï¼šåœ¨ LINE App ä¸­æ‰‹å‹•ç§»é™¤æˆæ¬Š**

1. é–‹å•Ÿ LINE App
2. å‰å¾€ **ã€Œè¨­å®šã€** (âš™ï¸)
3. é»æ“Š **ã€Œéš±ç§è¨­å®šã€**
4. é»æ“Š **ã€Œå·²æˆæ¬Šçš„æ‡‰ç”¨ç¨‹å¼ã€** æˆ– ã€Œæä¾›å€‹äººè³‡è¨Šçš„æœå‹™ã€
5. æ‰¾åˆ°æ‚¨çš„ LIFF App åç¨±
6. é»æ“Šä¸¦é¸æ“‡ **ã€Œç§»é™¤ã€** æˆ– ã€Œåˆªé™¤ã€
7. é‡æ–°é–‹å•Ÿæ‚¨çš„ LIFF App
8. ç³»çµ±æœƒè¦æ±‚é‡æ–°æˆæ¬Šï¼ˆè«‹åŒæ„ï¼‰

#### **æ–¹æ³• Cï¼šä½¿ç”¨ç„¡ç—•æ¨¡å¼æ¸¬è©¦**

å¦‚æœæ˜¯åœ¨é›»è…¦ç€è¦½å™¨æ¸¬è©¦ï¼š
1. é–‹å•Ÿç„¡ç—•/éš±ç§æ¨¡å¼
2. è¨ªå• LIFF URL
3. é‡æ–°æˆæ¬Š

---

### **æ­¥é©Ÿ 3ï¼šé©—è­‰ä¿®å¾©**

1. é–‹å•Ÿæ‚¨çš„ LIFF Appï¼ˆåœ¨ LINE ä¸­ï¼‰
2. æŒ‰ F12 é–‹å•Ÿé–‹ç™¼è€…å·¥å…·ï¼ˆå¦‚æœæ˜¯é›»è…¦æ¸¬è©¦ï¼‰
3. é»æ“Šã€Œå–å¾—æœ€æ–°å„ªæƒ è³‡è¨Šã€æŒ‰éˆ•
4. æ‡‰è©²æœƒçœ‹åˆ°æˆåŠŸçš„è¨Šæ¯ï¼

#### é æœŸçš„ Console æ—¥èªŒï¼š

```
ğŸš€ é–‹å§‹ç™¼é€å„ªæƒ è¨Šæ¯...
1ï¸âƒ£ åˆå§‹åŒ– LIFF...
ğŸ”‘ ä½¿ç”¨ LIFF ID: 2008576354-nwJ6w230
âœ… LIFF åˆå§‹åŒ–æˆåŠŸ
ğŸ“± LIFF SDK ç‰ˆæœ¬: 2.x.x
ğŸŒ åŸ·è¡Œç’°å¢ƒ: LINE App
ğŸ” ç™»å…¥ç‹€æ…‹: å·²ç™»å…¥
2ï¸âƒ£ æª¢æŸ¥ LINE ç’°å¢ƒ...
âœ… ç’°å¢ƒæª¢æŸ¥é€šé
3ï¸âƒ£ å–å¾—ä½¿ç”¨è€…è³‡è¨Š...
âœ… å–å¾—ä½¿ç”¨è€… UID: U1234567890...
4ï¸âƒ£ å–å¾—å„ªæƒ å•†å“è³‡æ–™...
âœ… å•†å“è³‡æ–™: [...]
5ï¸âƒ£ ç™¼é€ Flex Message åˆ° Google Apps Script...
âœ… Flex Message ç™¼é€æˆåŠŸ
âœ… å…¨éƒ¨å®Œæˆï¼
```

---

## ğŸ¯ é—œéµæª¢æŸ¥æ¸…å–®

ä¿®å¾©å‰è«‹ç¢ºèªï¼š

- [ ] LIFF App Scopes åŒ…å« `profile`
- [ ] LIFF App Scopes åŒ…å« `openid`
- [ ] é»æ“Šã€ŒUpdateã€å„²å­˜è¨­å®š
- [ ] æ¸…é™¤äº†èˆŠçš„æˆæ¬Šï¼ˆä½¿ç”¨ä¸Šè¿°ä»»ä¸€æ–¹æ³•ï¼‰
- [ ] é‡æ–°é–‹å•Ÿ LIFF App
- [ ] åŒæ„é‡æ–°æˆæ¬Š

---

## ğŸ“± é‡æ–°æˆæ¬Šç•«é¢èªªæ˜

æ¸…é™¤æˆæ¬Šå¾Œï¼Œç¬¬ä¸€æ¬¡é–‹å•Ÿ LIFF App æ™‚ï¼Œæœƒçœ‹åˆ°æˆæ¬Šç•«é¢ï¼š

```
[æ‚¨çš„ LIFF App åç¨±] è¦æ±‚å­˜å–ä»¥ä¸‹è³‡è¨Šï¼š

âœ“ æ‚¨çš„é¡¯ç¤ºåç¨±
âœ“ æ‚¨çš„å€‹äººè³‡æ–™åœ–ç‰‡
âœ“ æ‚¨çš„ç‹€æ…‹è¨Šæ¯

[åŒæ„] [å–æ¶ˆ]
```

**è«‹é»æ“Šã€ŒåŒæ„ã€**ï¼Œé€™æ¨£ LIFF App æ‰èƒ½å–å¾—å¿…è¦çš„æ¬Šé™ã€‚

---

## ğŸ”§ å¦‚æœä»ç„¶å¤±æ•—

### æª¢æŸ¥ 1ï¼šç¢ºèª LIFF ID

åœ¨ Console ä¸­åŸ·è¡Œï¼š

```javascript
console.log('LIFF ID:', liffId)
```

æ‡‰è©²é¡¯ç¤ºï¼š`2008576354-nwJ6w230`

### æª¢æŸ¥ 2ï¼šç¢ºèª Scopes å·²ç”Ÿæ•ˆ

1. å‰å¾€ LINE Developers Console
2. LIFF â†’ æ‚¨çš„ LIFF App
3. ç¢ºèªã€ŒScopesã€å€å¡Šé¡¯ç¤º `profile, openid`

### æª¢æŸ¥ 3ï¼šæ¸¬è©¦åŸºæœ¬çš„ LIFF åŠŸèƒ½

åœ¨ Console ä¸­åŸ·è¡Œï¼š

```javascript
liff.init({ liffId: '2008576354-nwJ6w230' })
  .then(() => {
    console.log('âœ… LIFF åˆå§‹åŒ–æˆåŠŸ')
    console.log('ç™»å…¥ç‹€æ…‹:', liff.isLoggedIn())
    console.log('ç’°å¢ƒ:', liff.isInClient() ? 'LINE App' : 'å¤–éƒ¨ç€è¦½å™¨')
    
    if (liff.isLoggedIn()) {
      return liff.getProfile()
    } else {
      console.warn('æœªç™»å…¥ï¼Œå˜—è©¦ç™»å…¥...')
      liff.login()
    }
  })
  .then(profile => {
    if (profile) {
      console.log('âœ… æˆåŠŸå–å¾—ä½¿ç”¨è€…è³‡è¨Š:', profile)
      console.log('User ID:', profile.userId)
      console.log('é¡¯ç¤ºåç¨±:', profile.displayName)
    }
  })
  .catch(error => {
    console.error('âŒ éŒ¯èª¤:', error)
    console.error('éŒ¯èª¤è¨Šæ¯:', error.message)
  })
```

å¦‚æœé€™æ®µä»£ç¢¼æˆåŠŸåŸ·è¡Œï¼Œè¡¨ç¤º Scopes è¨­å®šæ­£ç¢ºã€‚

---

## ğŸ—‘ï¸ ç§»é™¤è‡¨æ™‚èª¿è©¦æŒ‰éˆ•

ä¿®å¾©å®Œæˆä¸¦ç¢ºèªåŠŸèƒ½æ­£å¸¸å¾Œï¼Œå¯ä»¥ç§»é™¤ç´…è‰²çš„ã€Œæ¸…é™¤æˆæ¬Šã€æŒ‰éˆ•ï¼š

1. é–‹å•Ÿ `personalizedpage-omo.html`
2. æ‰¾åˆ°ç¬¬ 2625-2628 è¡Œï¼ˆè‡¨æ™‚èª¿è©¦æŒ‰éˆ•ï¼‰
3. åˆªé™¤è©²æŒ‰éˆ•ä»£ç¢¼
4. é‡æ–°éƒ¨ç½²

---

## ğŸ“š ç›¸é—œæ–‡æª”

- [LIFF Scopes èªªæ˜](https://developers.line.biz/en/docs/liff/using-user-profile/)
- [LIFF æˆæ¬Šæµç¨‹](https://developers.line.biz/en/docs/liff/overview/#authorization)
- [LINE Developers Console](https://developers.line.biz/console/)

---

## ğŸ†˜ å…¶ä»–å¸¸è¦‹ Scope éŒ¯èª¤

### éŒ¯èª¤ï¼š`email is not in scope`

**è§£æ±ºæ–¹å¼**ï¼šåœ¨ LIFF App Scopes ä¸­å‹¾é¸ `email`

### éŒ¯èª¤ï¼š`chat_message.write is not in scope`

**è§£æ±ºæ–¹å¼**ï¼šåœ¨ LIFF App Scopes ä¸­å‹¾é¸ `chat_message.write`

---

## âœ… æˆåŠŸæ¨™èªŒ

ä¿®å¾©æˆåŠŸå¾Œï¼Œæ‚¨æ‡‰è©²èƒ½å¤ ï¼š

1. âœ… é»æ“Šã€Œå–å¾—æœ€æ–°å„ªæƒ è³‡è¨Šã€æŒ‰éˆ•
2. âœ… ä¸æœƒçœ‹åˆ°éŒ¯èª¤è¨Šæ¯
3. âœ… LINE æ”¶åˆ°åŒ…å«å•†å“è³‡è¨Šçš„ Flex Message
4. âœ… Console é¡¯ç¤ºå®Œæ•´çš„æˆåŠŸæ—¥èªŒ

---

**ä¿®å¾©æ™‚é–“**ï¼šç´„ 2-5 åˆ†é˜  
**é›£åº¦**ï¼šâ­â­â˜†â˜†â˜†ï¼ˆç°¡å–®ï¼‰  
**æœ€å¾Œæ›´æ–°**ï¼š2025-11-27

